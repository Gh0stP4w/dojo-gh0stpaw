---
description: >-
  This page documents the step-by-step investigation of a file executed on
  JohnComputer, initially flagged as malicious and later confirmed as a false
  positive after sandboxing, hash and log analysis.
icon: file-circle-exclamation
---

# SOC104 - Malware Detected

## ğŸ§­ 1. Alert Details

* EventID : 14
* Event Time : **Sep, 15, 2020, 09:02 PM**
* Source Address : **172.16.17.82**
* Source Hostname : **JohnComputer**
* File Name : _**googleupdate.exe**_
* File Hash : **0bca3f16dd527b4150648ec1e36cb22a**
* Device Action : **Allowed**

<figure><img src="../.gitbook/assets/0_incidentDetails.png" alt=""><figcaption></figcaption></figure>

## âš™ï¸ 2. Start of Investigation

* Case created and playbook started.

<figure><img src="../.gitbook/assets/1_caseManagement.png" alt=""><figcaption></figcaption></figure>

* Threat indicator set to "Other".

<figure><img src="../.gitbook/assets/2_startingPlaybook.png" alt=""><figcaption></figcaption></figure>

## ğŸ§¼ 3. Quarantine Check

* The â€œNot Quarantinedâ€ field was marked based on the **Device Action (Allowed)**
* Manual inspection is required.

<figure><img src="../.gitbook/assets/3_checking_quarantined-cleaned.png" alt=""><figcaption></figcaption></figure>

## ğŸ§  4. Malware Analysis

Before marking whether the malware was malicious or not, an analysis was done with third-party tools and C2 addresses

<figure><img src="../.gitbook/assets/4_analyzeMalware.png" alt=""><figcaption></figcaption></figure>

* **VirusTotal:** 0/72 engines flag as malicious.

<figure><img src="../.gitbook/assets/6_virusTotal.png" alt=""><figcaption></figcaption></figure>

* **Hybrid Analysis:** Normal behavior, no persistence attempts or C2 connections.

<figure><img src="../.gitbook/assets/8_hybridAnalysis.png" alt=""><figcaption></figcaption></figure>

* **URLScan e URLhaus:** nothing malicious related to the hash or the source IP.

<figure><img src="../.gitbook/assets/7_urlAbuse.png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/12_urlScan.png" alt=""><figcaption></figcaption></figure>

ğŸ“Œ Partial conclusion: so far, everything points to a **false positive**.

## ğŸ” 5. Process and Log Analysis

* Verified that the process was started by _**taskeng.exe**_ â€” typical of legitimate scheduled tasks.
* File location: `C:\Program Files (x86)\Google\Update\GoogleUpdate.exe`

<figure><img src="../.gitbook/assets/9_endpointSecurity_googleupdateProcess.png" alt=""><figcaption></figcaption></figure>

ğŸ“Œ Reinforces authenticity: location and process are consistent with expected Google updater behavior.

* Logs filtered by host IP

<figure><img src="../.gitbook/assets/5_logManagement.png" alt=""><figcaption></figcaption></figure>

* Nothing anomalous detected in traffic during execution

<figure><img src="../.gitbook/assets/10_terminalHistory.png" alt=""><figcaption></figcaption></figure>

* Terminal and browser history consistent with normal use â€” no signs of malicious script execution.

<figure><img src="../.gitbook/assets/11_browserHistory.png" alt=""><figcaption></figcaption></figure>

* &#x20;Since nothing was found to indicate that the file was malicious, it was marked as **Non-Malicious**.
* So we proceed with the Playbook

## ğŸ§ª 6. Artifact Collection

* File hash added as artifact.
* No malicious domains or IPs associated with the file.

<figure><img src="../.gitbook/assets/13_addArtifacts.png" alt=""><figcaption></figcaption></figure>

## âœ… 7. Conclusion

* Alert closed as false positive.
* No further action required on the endpoint.

<figure><img src="../.gitbook/assets/14_closedAlert.png" alt=""><figcaption></figcaption></figure>

## ğŸ” Analyst Note

At this time, there is no solid evidence that the file is malicious. It is likely a legitimate Chrome update process. However, as a precaution, it is recommended to confirm directly with the user whether they initiated an update around the alert time. If confirmed, this activity can be marked as benign and the file may be whitelisted to reduce false positives in the future.

If any unusual behavior is reported by the user or identified in follow-up logs, further investigation is advised.
